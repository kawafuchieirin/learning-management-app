# 学習記録管理アプリ 📚

学習記録を管理し、学習ロードマップとの連携で計画的な学習を支援するWebアプリケーションです。
**DynamoDB Local** を使用してローカル開発環境で柔軟なデータ管理を実現し、将来的にAWS DynamoDBへの移行も簡単に行えます。

## 🎯 主要機能

### 📝 学習記録管理
- **学習記録の追加**: 日付、内容、時間、カテゴリーを記録
- **メモ機能**: 
  - 理解できたこと（振り返り・成長記録）
  - できなかったこと（改善課題の管理）
- **ロードマップ連携**: 学習記録をロードマップ・マイルストーンと関連付け
- **CSVエクスポート**: 学習記録をCSV形式でダウンロード
- **編集・削除**: 既存の学習記録の編集・削除機能

### 🗺️ 学習ロードマップ
- **ロードマップ作成**: 学習計画をマイルストーン形式で管理
- **改善された進捗管理**: 
  - **完了度合いベースの進捗**: チェック済み→100%、未完了→時間ベース（最大100%）
  - 時間進捗の上限制限（100%以上は表示されない）
  - 実際の達成感を反映した進捗表示
- **コンパクトな詳細画面**: 
  - 統合された概要カード（進捗・時間・スケジュール）
  - 簡潔なマイルストーン表示
  - 関連学習記録のコンパクト表示（最新5件）
- **CSVインポート**: CSVファイルから複数のロードマップを一括作成
- **サンプルCSVダウンロード**: 入力用CSVのテンプレート取得
- **マイルストーン管理**: 
  - 推定時間（時間単位）の設定
  - 完了状況のチェックボックス切り替え
  - 学習時間の集計表示
  - 実績時間 vs 予定時間の比較表示

### ⏱️ 学習タイマー
- **基本タイマー機能**: 開始・一時停止・停止・リセット
- **プリセット時間**: ポモドーロ、大学講義、集中学習などの設定
- **ロードマップ連携**: 
  - ロードマップ・マイルストーンの事前選択
  - 推定時間に基づくプリセット自動設定
  - 完了時の自動記録連携
- **セッション記録**: タイマー完了時に学習記録として自動保存
- **リアルタイム統計**: 今日の学習時間と今回セッション時間の表示

### 📊 ダッシュボード・統計
- **モチベーション機能**: 
  - レベル・経験値システム（学習時間に基づく成長）
  - 連続学習ストリーク（毎日の学習継続を可視化）
  - 達成バッジシステム（学習マイルストーンの報酬）
  - モチベーション向上メッセージ
- **成長グラフ**: 
  - 30日間の学習時間推移（Chart.js）
  - 日別学習時間・累積時間・7日間平均の表示
  - 学習傾向の分析（向上中・安定・低下）
- **学習統計**: 
  - 今週・全期間の学習時間
  - 学習日数と平均時間
  - セッション数と平均セッション時間
- **メモハイライト**: 最近の「理解できたこと」「できなかったこと」
- **最近の学習記録**: 直近の学習記録一覧
- **カテゴリー別統計**: 学習分野ごとの時間集計と分析

### 🔗 高度な連携機能
- **ロードマップからタイマー開始**: 
  - ロードマップ一覧からワンクリックでタイマー開始
  - マイルストーン別の学習開始
  - URLパラメータによる事前選択
- **学習時間の自動集計**: 
  - ロードマップ別の総学習時間
  - マイルストーン別の実績時間
  - 進捗の可視化（プログレスバー）
- **関連学習記録の表示**: ロードマップに関連する学習記録の一覧

## 🚀 セットアップ

### 1. 前提条件

- **Python 3.7+**: アプリケーション実行環境
- **Java 8+**: DynamoDB Local実行に必要

### 2. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 3. アプリケーションの起動

**方法1: 統合起動スクリプト（推奨）**
```bash
python run.py
```
このコマンドで、DynamoDB LocalとFlaskアプリが同時に起動します。

**方法2: 本番モード**
```bash
python run_production.py
```

**方法3: 個別起動**
```bash
# ターミナル1: DynamoDB Localを起動
python setup_dynamodb.py

# ターミナル2: Flaskアプリを起動
python app.py
```

### 4. ブラウザでアクセス

```
http://localhost:5000
```

### 5. データのバックアップ・復元

```bash
# データのバックアップ
python backup_data.py backup

# データの復元
python backup_data.py restore
```

## 🗄️ データベース構造

### DynamoDB テーブル設計

#### 学習記録テーブル: `study_records`

**キー設計**:
- **Partition Key**: `user_id` (String) - ユーザー識別子
- **Sort Key**: `record_id` (String) - 記録ID（タイムスタンプ + UUID）

**属性**:
| 属性名 | 型 | 説明 | 必須 |
|--------|----|----|------|
| user_id | String | ユーザー識別子 | ✅ |
| record_id | String | 記録ID | ✅ |
| date | String | 記録日 (YYYY-MM-DD) | ✅ |
| content | String | 学習内容 | ✅ |
| time | Number | 学習時間（分） | ✅ |
| category | String | カテゴリー | ✅ |
| could_not_do | String | できなかったこと | ❌ |
| understood | String | 理解できたこと | ❌ |
| roadmap_id | String | 関連ロードマップID | ❌ |
| milestone_id | String | 関連マイルストーンID | ❌ |
| source | String | 記録元（manual/timer） | ❌ |
| created_at | String | 作成日時 (ISO形式) | ✅ |

#### ロードマップテーブル: `learning_roadmaps`

**キー設計**:
- **Partition Key**: `user_id` (String) - ユーザー識別子
- **Sort Key**: `roadmap_id` (String) - ロードマップID

**属性**:
| 属性名 | 型 | 説明 | 必須 |
|--------|----|----|------|
| user_id | String | ユーザー識別子 | ✅ |
| roadmap_id | String | ロードマップID | ✅ |
| title | String | ロードマップタイトル | ✅ |
| description | String | 説明 | ❌ |
| goal | String | 最終目標 | ❌ |
| milestones | List | マイルストーン配列 | ✅ |
| status | String | ステータス | ✅ |
| source | String | 作成元（manual/csv_import） | ❌ |
| created_at | String | 作成日時 (ISO形式) | ✅ |

**マイルストーン構造**:
```json
{
  "id": "string",
  "title": "string",
  "description": "string",
  "estimated_hours": "number",
  "completed": "boolean",
  "completed_date": "string (ISO)"
}
```

## 📱 使用方法

### 基本的な学習記録
1. **記録追加**: 「記録を追加」から学習内容を入力
2. **メモ入力**: 理解できたことや課題を記録
3. **カテゴリー選択**: プログラミング、数学、英語など
4. **ロードマップ連携**: 任意でロードマップ・マイルストーンを選択

### ロードマップベースの学習
1. **ロードマップ作成**: 学習計画をマイルストーン形式で作成
2. **CSVインポート**: 大量のロードマップを一括作成
3. **タイマー開始**: ロードマップ・マイルストーンから直接学習開始
4. **進捗確認**: 完了状況と時間進捗を可視化

### 学習タイマーの活用
1. **通常使用**: 学習内容を入力してタイマー開始
2. **ロードマップ連携**: 
   - ロードマップ一覧の時計アイコンをクリック
   - マイルストーンの「学習開始」ボタンをクリック
3. **自動記録**: 完了時に学習記録として自動保存

### データの分析・エクスポート
1. **統計確認**: ダッシュボードでカテゴリー別統計を確認
2. **CSVエクスポート**: 学習記録をExcelで分析
3. **メモ振り返り**: 理解度と課題の整理

## 🔧 技術スタック

- **フロントエンド**: HTML, CSS, JavaScript, Bootstrap 5, Font Awesome
- **バックエンド**: Python Flask
- **データベース**: DynamoDB Local / AWS DynamoDB
- **AWS SDK**: Boto3

## 📄 CSVインポート機能

### ロードマップCSVフォーマット

| 列名 | 説明 | 例 |
|------|------|-----|
| ロードマップタイトル | 新しいロードマップの場合は入力、同じロードマップの続きは空欄 | Pythonマスターへの道 |
| 説明 | ロードマップの説明 | Pythonを基礎から応用まで体系的に学習 |
| 目標 | 最終目標 | 実用的なアプリケーションを開発できるようになる |
| マイルストーンタイトル | ステップの名前 | Python基礎文法 |
| マイルストーン説明 | ステップの詳細 | 変数、データ型、制御構文などの基本 |
| 推定時間 | 完了までの推定時間（時間） | 20 |

### サンプルCSVの取得
インポートページから「サンプルCSVをダウンロード」をクリックして、入力用テンプレートを取得できます。

## 🌟 DynamoDB Local の利点

- **ノーコスト開発**: AWS料金を気にせずに開発可能
- **高速レスポンス**: ローカル実行による高速なデータ操作
- **柔軟なスキーマ**: 後から属性を追加しやすいNoSQL設計
- **AWS互換**: AWS DynamoDBへの移行が簡単
- **オフライン開発**: インターネット接続なしでも開発可能

## 🔄 AWS DynamoDB への移行

本番環境でAWS DynamoDBを使用する場合は、`app.py`の以下の設定を変更してください：

```python
# ローカル開発用
dynamodb = boto3.resource(
    'dynamodb',
    endpoint_url="http://localhost:8002",  # この行を削除
    region_name="ap-northeast-1",
    aws_access_key_id="fakeMyKeyId",      # 実際のAWSクレデンシャルを設定
    aws_secret_access_key="fakeSecretAccessKey"  # 実際のAWSクレデンシャルを設定
)

# 本番環境用
dynamodb = boto3.resource(
    'dynamodb',
    region_name="ap-northeast-1"
)
```

## 📚 アプリケーション構成

### ファイル構造
```
learning-management-app/
├── app.py                    # メインアプリケーション
├── run.py                    # 統合起動スクリプト（推奨）
├── start.py                  # 簡易起動スクリプト
├── run_production.py         # 本番モード起動
├── setup_dynamodb.py         # DynamoDB Local セットアップ
├── backup_data.py            # データバックアップ・復元
├── requirements.txt          # Python依存関係
├── CLAUDE.md                 # 開発者向けガイド
├── templates/                # HTMLテンプレート
│   ├── base.html            # 基本レイアウト
│   ├── dashboard.html       # ダッシュボード
│   ├── add_record.html      # 記録追加
│   ├── records.html         # 記録一覧
│   ├── edit_record.html     # 記録編集
│   ├── memo_insights.html   # メモ振り返り
│   ├── timer.html           # 学習タイマー
│   ├── roadmaps.html        # ロードマップ一覧
│   ├── roadmap_detail.html  # ロードマップ詳細
│   ├── add_roadmap.html     # ロードマップ作成
│   ├── edit_roadmap.html    # ロードマップ編集
│   ├── import_roadmap_csv.html # CSVインポート
│   └── category_stats.html  # カテゴリー統計
└── dynamodb_local/          # DynamoDB Local ファイル（自動生成）
```

### 主要なルート
| ルート | 機能 |
|--------|------|
| `/` | ダッシュボード |
| `/add_record` | 学習記録追加 |
| `/records` | 学習記録一覧 |
| `/timer` | 学習タイマー |
| `/roadmaps` | ロードマップ一覧 |
| `/roadmap/<id>` | ロードマップ詳細 |
| `/import_roadmap_csv` | CSVインポート |
| `/download_roadmap_sample_csv` | サンプルCSV取得 |
| `/memo_insights` | メモ振り返り |
| `/category_stats` | カテゴリー別統計 |
| `/export_csv` | 学習記録CSVエクスポート |

## 🚀 今後の拡張可能性

- **マルチユーザー対応**: 認証機能の追加
- **チーム機能**: グループでの学習管理
- **通知機能**: 学習リマインダー
- **モバイルアプリ**: PWA対応
- **AI支援**: 学習提案機能
- **外部連携**: GitHub、Slack等との連携

## 💡 開発のポイント

- **シングルユーザー**: 現在は`default_user`で単一ユーザー運用
- **NoSQL設計**: DynamoDBの特性を活かした柔軟なスキーマ
- **時間ベース進捗**: 従来の完了ベースに加えて時間による進捗管理
- **CSV連携**: 大量データの効率的な入力・出力
- **レスポンシブデザイン**: Bootstrap 5によるモバイル対応

学習の記録・計画・実行を一元管理し、効率的な学習サイクルを支援するアプリケーションです。